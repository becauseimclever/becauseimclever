services:
  web:
    image: ghcr.io/becauseimclever/becauseimclever:main
    container_name: becauseimclever
    restart: unless-stopped
    ports:
      - "8580:8580"
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
      - ASPNETCORE_URLS=http://+:8580
      # Email settings from .env file
      - EmailSettings__SmtpHost=${SMTP_HOST}
      - EmailSettings__SmtpPort=${SMTP_PORT}
      - EmailSettings__SmtpUsername=${SMTP_USERNAME}
      - EmailSettings__SmtpPassword=${SMTP_PASSWORD}
      - EmailSettings__EnableSsl=${SMTP_ENABLE_SSL}
      - EmailSettings__FromAddress=${SMTP_FROM_ADDRESS}
      - EmailSettings__FromName=${SMTP_FROM_NAME}
      - EmailSettings__ToAddress=${SMTP_TO_ADDRESS}
      # Database connection string
      - ConnectionStrings__BlogDb=Host=${DB_HOST};Port=${DB_PORT};Database=${DB_NAME};Username=${DB_USERNAME};Password=${DB_PASSWORD}
      # Authentik authentication settings
      - Authentication__Authentik__Authority=${AUTHENTIK_AUTHORITY}
      - Authentication__Authentik__ClientId=${AUTHENTIK_CLIENT_ID}
      - Authentication__Authentik__ClientSecret=${AUTHENTIK_CLIENT_SECRET}
      - Authentication__Authentik__AdminGroup=${AUTHENTIK_ADMIN_GROUP}
    env_file:
      - .env
