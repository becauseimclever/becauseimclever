@page "/posts/{Slug}"
@using BecauseImClever.Application.Interfaces
@using BecauseImClever.Domain.Entities
@inject IBlogService BlogService

<main class="main-content">
    <div class="content-area">
        @if (post == null)
        {
            @if (notFound)
            {
                <PageTitle>Post Not Found</PageTitle>
                <div class="card">
                    <h1>Post Not Found</h1>
                    <p>Sorry, the post you are looking for does not exist.</p>
                </div>
            }
            else
            {
                <p>Loading...</p>
            }
        }
        else
        {
            <PageTitle>@post.Title</PageTitle>
            <article class="card">
                <h1>@post.Title</h1>
                <div class="card-meta">@post.PublishedDate.ToString("MMMM dd, yyyy")</div>
                <hr style="border: 0; border-top: 1px solid var(--border-color); margin: 1rem 0;" />
                <div>
                    @((MarkupString)post.Content)
                </div>
            </article>
        }
    </div>
    <Sidebar />
</main>

@code {
    [Parameter]
    public string Slug { get; set; } = string.Empty;

    private BlogPost? post;
    private bool notFound = false;

    protected override async Task OnInitializedAsync()
    {
        post = await BlogService.GetPostBySlugAsync(Slug);
        if (post == null)
        {
            notFound = true;
        }
    }
}
