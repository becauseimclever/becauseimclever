@inherits LayoutComponentBase
@inject IJSRuntime JSRuntime

<div class="layout-container">
    <!-- Header -->
    <header>
        <div class="logo">&lt;BecauseImClever /&gt;</div>
        <nav>
            <ul>
                <li><a href="">Home</a></li>
                <li><a href="posts">Blog</a></li>
                <li><a href="projects">Projects</a></li>
                <li><a href="about">About</a></li>
            </ul>
        </nav>
        <button class="theme-switch" @onclick="ToggleTheme">Theme: @currentThemeName</button>
    </header>

    @Body

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 BecauseImClever. Built with .NET 10 & Blazor.</p>
    </footer>
</div>

@code {
    private string currentTheme = "vscode";
    private string currentThemeName = "VS Code";

    protected override async Task OnInitializedAsync()
    {
        // Initialize theme from local storage if available
        var savedTheme = await JSRuntime.InvokeAsync<string>("localStorage.getItem", "theme");
        if (!string.IsNullOrEmpty(savedTheme))
        {
            currentTheme = savedTheme;
            await ApplyTheme(currentTheme);
        }
    }

    private async Task ToggleTheme()
    {
        currentTheme = currentTheme == "retro" ? "vscode" : "retro";
        await ApplyTheme(currentTheme);
    }

    private async Task ApplyTheme(string theme)
    {
        if (theme == "retro")
        {
            currentThemeName = "Retro Terminal";
            await JSRuntime.InvokeVoidAsync("document.documentElement.setAttribute", "data-theme", "retro");
        }
        else
        {
            currentThemeName = "VS Code";
            await JSRuntime.InvokeVoidAsync("document.documentElement.removeAttribute", "data-theme");
        }
        await JSRuntime.InvokeVoidAsync("localStorage.setItem", "theme", theme);
    }
}
