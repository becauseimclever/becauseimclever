@inherits LayoutComponentBase
@inject IJSRuntime JSRuntime

<div class="layout-container">
    <!-- Header -->
    <header>
        <div class="logo">&lt;BecauseImClever /&gt;</div>
        <nav>
            <ul>
                <li><a href="">Home</a></li>
                <li><a href="posts">Blog</a></li>
                <li><a href="projects">Projects</a></li>
                <li><a href="about">About</a></li>
            </ul>
        </nav>
        <select class="theme-switch" @onchange="OnThemeChanged" value="@currentTheme">
            <option value="vscode">VS Code</option>
            <option value="retro">Retro Terminal</option>
            <option value="win95">Windows 95</option>
            <option value="macos9">Mac OS 9</option>
            <option value="macos7">Mac OS 7</option>
            <option value="geocities">GeoCities</option>
        </select>
    </header>

    @Body

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 BecauseImClever. Built with .NET 10 & Blazor.</p>
    </footer>
</div>

@code {
    private string currentTheme = "vscode";

    protected override async Task OnInitializedAsync()
    {
        // Initialize theme from local storage if available
        var savedTheme = await JSRuntime.InvokeAsync<string>("localStorage.getItem", "theme");
        if (!string.IsNullOrEmpty(savedTheme))
        {
            currentTheme = savedTheme;
            await ApplyTheme(currentTheme);
        }
    }

    private async Task OnThemeChanged(ChangeEventArgs e)
    {
        currentTheme = e.Value?.ToString() ?? "vscode";
        await ApplyTheme(currentTheme);
    }

    private async Task ApplyTheme(string theme)
    {
        if (theme == "vscode")
        {
            await JSRuntime.InvokeVoidAsync("document.documentElement.removeAttribute", "data-theme");
        }
        else
        {
            await JSRuntime.InvokeVoidAsync("document.documentElement.setAttribute", "data-theme", theme);
        }
        await JSRuntime.InvokeVoidAsync("localStorage.setItem", "theme", theme);
    }
}
